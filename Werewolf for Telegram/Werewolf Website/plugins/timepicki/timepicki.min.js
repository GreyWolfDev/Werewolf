!function(i){i.fn.timepicki=function(t){var e={format_output:function(i,t,e){return n.show_meridian?i+" : "+t+" : "+e:i+" : "+t},increase_direction:"down",custom_classes:"",min_hour_value:1,max_hour_value:12,show_meridian:!0,step_size_hours:"1",step_size_minutes:"1",overflow_minutes:!1,disable_keyboard_mobile:!1,reset:!1},n=i.extend({},e,t);return this.each(function(){function t(t){return i.contains(m[0],t[0])||m.is(t)}function e(i,t){var e=f.find(".ti_tx input").val(),a=f.find(".mi_tx input").val(),r="";n.show_meridian&&(r=f.find(".mer_tx input").val()),0===e.length||0===a.length||n.show_meridian&&0===r.length||(u.attr("data-timepicki-tim",e),u.attr("data-timepicki-mini",a),n.show_meridian?(u.attr("data-timepicki-meri",r),u.val(n.format_output(e,a,r))):u.val(n.format_output(e,a))),t&&s()}function a(){r(n.start_time),f.fadeIn();var t=f.find("input:visible").first();t.focus();var e=function(n){if(9===n.which&&n.shiftKey){t.off("keydown",e);var a=i(":input:visible:not(.timepicki-input)"),s=a.index(u),r=a.get(s-1);r.focus()}};t.on("keydown",e)}function s(){f.fadeOut()}function r(i){var t,e,a,s;u.is("[data-timepicki-tim]")?(e=Number(u.attr("data-timepicki-tim")),a=Number(u.attr("data-timepicki-mini")),n.show_meridian&&(s=u.attr("data-timepicki-meri"))):"object"==typeof i?(e=Number(i[0]),a=Number(i[1]),n.show_meridian&&(s=i[2])):(t=new Date,e=t.getHours(),a=t.getMinutes(),s="AM",e>12&&n.show_meridian&&(e-=12,s="PM")),f.find(".ti_tx input").val(10>e?"0"+e:e),f.find(".mi_tx input").val(10>a?"0"+a:a),n.show_meridian&&f.find(".mer_tx input").val(10>s?"0"+s:s)}function o(i,t){var e="time",a=Number(f.find("."+e+" .ti_tx input").val()),s=Number(n.min_hour_value),r=Number(n.max_hour_value),o=Number(n.step_size_hours);if(i&&i.hasClass("action-next")||"next"===t)if(a+o>r){var d=s;d=10>d?"0"+d:String(d),f.find("."+e+" .ti_tx input").val(d)}else a+=o,10>a&&(a="0"+a),f.find("."+e+" .ti_tx input").val(a);else if(i&&i.hasClass("action-prev")||"prev"===t)if(s>=a-o){var c=r;c=10>c?"0"+c:String(c),f.find("."+e+" .ti_tx input").val(c)}else a-=o,10>a&&(a="0"+a),f.find("."+e+" .ti_tx input").val(a)}function d(i,t){var e="mins",a=Number(f.find("."+e+" .mi_tx input").val()),s=0,r=59,d=Number(n.step_size_minutes);i&&i.hasClass("action-next")||"next"===t?a+d>r?(f.find("."+e+" .mi_tx input").val("00"),n.overflow_minutes&&o(null,"next")):(a+=d,f.find("."+e+" .mi_tx input").val(10>a?"0"+a:a)):(i&&i.hasClass("action-prev")||"prev"===t)&&(s>=a-d?(f.find("."+e+" .mi_tx input").val(r+1-d),n.overflow_minutes&&o(null,"prev")):(a-=d,f.find("."+e+" .mi_tx input").val(10>a?"0"+a:a)))}function c(i,t){var e="meridian",n=null;n=f.find("."+e+" .mer_tx input").val(),i&&i.hasClass("action-next")||"next"===t?f.find("."+e+" .mer_tx input").val("AM"==n?"PM":"AM"):(i&&i.hasClass("action-prev")||"prev"===t)&&f.find("."+e+" .mer_tx input").val("AM"==n?"PM":"AM")}var u=i(this),l=u.outerHeight();l+=10,i(u).wrap("<div class='time_pick'>");var m=i(this).parents(".time_pick"),p="down"===n.increase_direction?"<div class='prev action-prev'></div>":"<div class='prev action-next'></div>",v="down"===n.increase_direction?"<div class='next action-next'></div>":"<div class='next action-prev'></div>",_=i("<div class='timepicker_wrap "+n.custom_classes+"'><div class='arrow_top'></div><div class='time'>"+p+"<div class='ti_tx'><input type='text' class='timepicki-input'"+(n.disable_keyboard_mobile?"readonly":"")+"></div>"+v+"</div><div class='mins'>"+p+"<div class='mi_tx'><input type='text' class='timepicki-input'"+(n.disable_keyboard_mobile?"readonly":"")+"></div>"+v+"</div>");n.show_meridian&&_.append("<div class='meridian'>"+p+"<div class='mer_tx'><input type='text' class='timepicki-input' readonly></div>"+v+"</div>"),n.reset&&_.append("<div><a href='#' class='reset_time'>Reset</a></div>"),m.append(_);var f=i(this).next(".timepicker_wrap"),h=(f.find("div"),m.find("input"));i(".reset_time").on("click",function(){u.val(""),s()}),i(".timepicki-input").keydown(function(t){var e=i(this).val().length;-1!==i.inArray(t.keyCode,[46,8,9,27,13,110,190])||65==t.keyCode&&t.ctrlKey===!0||t.keyCode>=35&&t.keyCode<=39||((t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)||2==e)&&t.preventDefault()}),i(document).on("click",function(n){if(!i(n.target).is(f)&&"block"==f.css("display")&&!i(n.target).is(i(".reset_time")))if(i(n.target).is(u)){var s=0;f.css({top:l+"px",left:s+"px"}),a()}else e(n,!t(i(n.target)))}),u.on("focus",a),h.on("focus",function(){var t=i(this);t.is(u)||t.select()}),h.on("keydown",function(t){var e,a=i(this);38===t.which?e="down"===n.increase_direction?"prev":"next":40===t.which&&(e="down"===n.increase_direction?"next":"prev"),a.closest(".timepicker_wrap .time").length?o(null,e):a.closest(".timepicker_wrap .mins").length?d(null,e):a.closest(".timepicker_wrap .meridian").length&&n.show_meridian&&c(null,e)}),h.on("blur",function(){setTimeout(function(){var n=i(document.activeElement);n.is(":input")&&!t(n)&&(e(),s())},0)});var x=f.find(".action-next"),k=f.find(".action-prev");i(k).add(x).on("click",function(){var t=i(this);"time"==t.parent().attr("class")?o(t):"mins"==t.parent().attr("class")?d(t):n.show_meridian&&c(t)})})}}(jQuery);